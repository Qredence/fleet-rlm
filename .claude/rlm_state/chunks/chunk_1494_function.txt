<!-- Chunk 1494: bytes 6333070-6334948, type=function -->
def _configure_cors(app: FastAPI) -> None:
    """
    Configure CORS with security validation.

    Enforces:
    - Explicit origins required in production
    - Wildcard (*) only allowed in development
    - Credentials disabled when using wildcard

    Args:
        app: FastAPI application instance

    Raises:
        ValueError: If CORS configuration is invalid for production

    """
    cors_origins = settings.cors_origins_list

    # Default to wildcard in development only
    if not cors_origins:
        if settings.is_development:
            logger.warning("CORS_ORIGINS not set; defaulting to '*' in development")
            cors_origins = ["*"]
        else:
            raise ValueError(
                "SKILL_FLEET_CORS_ORIGINS must be set in production environment. "
                "Set it to a comma-separated list of allowed origins, or set "
                "SKILL_FLEET_ENV=development for testing with wildcards."
            )

    # Security check: wildcard not allowed in production
    if "*" in cors_origins and not settings.is_development:
        raise ValueError(
            "Wildcard CORS origin ('*') is not allowed in production. "
            "Set SKILL_FLEET_CORS_ORIGINS to a comma-separated list of allowed origins."
        )

    # Prefer explicit origins over wildcard
    if "*" in cors_origins and len(cors_origins) > 1:
        cors_origins = [o for o in cors_origins if o != "*"]

    if "*" in cors_origins:
        logger.warning(
            "CORS wildcard disables credentials (cookies, auth headers). "
            "Use explicit origins in production for authenticated requests."
        )

    app.add_middleware(
        CORSMiddleware,  # type: ignore[arg-type]
        allow_origins=cors_origins,
        allow_credentials="*" not in cors_origins,
        allow_methods=["*"],
        allow_headers=["*"],
    )


