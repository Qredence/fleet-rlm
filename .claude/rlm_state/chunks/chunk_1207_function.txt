<!-- Chunk 1207: bytes 4553063-4554379, type=function -->
def split_sql_script(script: str) -> list[str]:
    """
    Split SQL script into individual statements.

    Handles PostgreSQL-specific syntax like CREATE TYPE which uses $BODY$ delimiters.
    """
    statements = []
    current = []
    in_body = False

    for line in script.split("\n"):
        # Check for BODY delimiter start/end
        if "$$" in line:
            if not in_body:
                in_body = True
                current.append(line)
                continue
            elif in_body:
                in_body = False
                current.append(line)
                # Check if statement ends here
                if ";" in line:
                    stmt = "\n".join(current).strip()
                    if stmt:
                        statements.append(stmt)
                    current = []
                continue

        current.append(line)

        # If not in BODY and line ends with semicolon, it's a complete statement
        if not in_body and line.strip().endswith(";"):
            stmt = "\n".join(current).strip()
            if stmt:
                statements.append(stmt)
            current = []

    # Add any remaining content
    if current:
        stmt = "\n".join(current).strip()
        if stmt:
            statements.append(stmt)

    return statements


