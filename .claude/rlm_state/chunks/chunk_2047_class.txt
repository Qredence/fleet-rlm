<!-- Chunk 2047: bytes 7947941-7953545, type=class -->
class MockLM(LM):
    """Mock LM that returns predictable responses."""

    def __init__(self):
        super().__init__(model="mock/model")

    def __call__(self, prompt=None, messages=None, **kwargs):
        """Mock LLM responses based on prompt content.

        Accepts both prompt (string) and messages (list) formats.
        """
        # Use prompt if provided, otherwise extract from messages
        if prompt:
            prompt_str = str(prompt).lower()
        elif messages:
            prompt_str = str(messages).lower()
        else:
            prompt_str = ""

        # Requirements gathering response
        if "requirements" in prompt_str or "domain" in prompt_str:
            return self._mock_requirements_response()

        # Intent analysis response
        if "intent" in prompt_str or "purpose" in prompt_str:
            return self._mock_intent_response()

        # Taxonomy path response
        if "taxonomy" in prompt_str or "path" in prompt_str:
            return self._mock_taxonomy_response()

        # Dependencies response
        if "depend" in prompt_str or "prerequisite" in prompt_str:
            return self._mock_dependencies_response()

        # Plan synthesis response
        if "plan" in prompt_str or "synthesize" in prompt_str:
            return self._mock_plan_response()

        # HITL questions response
        if "question" in prompt_str or "clarif" in prompt_str:
            return self._mock_questions_response()

        # Default response
        return self._mock_default_response()

    def _mock_requirements_response(self):
        return """domain: technical
category: frontend
target_level: intermediate
topics: ["react", "components", "typescript", "testing"]
constraints: ["TypeScript", "production-ready"]
ambiguities: []"""

    def _mock_requirements_with_ambiguities_response(self):
        return """domain: technical
category: general
target_level: intermediate  
topics: ["general-programming"]
constraints: []
ambiguities: ["Unclear what specific technology or framework", "Scope not well-defined - could be web, mobile, or desktop"]"""

    def _mock_intent_response(self):
        return """purpose: Help developers build reusable React components
problem_statement: Teams struggle with inconsistent UI and duplicated component code across projects
target_audience: Frontend developers with basic React knowledge
value_proposition: Provides production-ready, tested component patterns with TypeScript support
skill_type: how_to
scope: Covers component design, implementation, testing, and documentation. Does NOT cover backend integration or deployment.
success_criteria: ["Can create reusable components", "Implements proper TypeScript types", "Writes component tests", "Documents component API"]"""

    def _mock_taxonomy_response(self):
        return """recommended_path: technical/frontend/react-components
alternative_paths: ["web/react-patterns", "javascript/react-advanced"]
path_rationale: React components fit best in frontend category. Follows existing structure of technical/frontend path.
new_directories: []
confidence: 0.85"""

    def _mock_dependencies_response(self):
        return """prerequisite_skills: ["javascript: JavaScript fundamentals required", "react-basics: Basic React concepts needed"]
complementary_skills: ["testing: Useful for component testing", "typescript: Enhances type safety"]
conflicting_skills: []
missing_prerequisites: []
dependency_rationale: JavaScript and basic React are essential. Testing and TypeScript enhance but aren't required."""

    def _mock_plan_response(self):
        return """skill_name: react-component-library
skill_description: Use when you need to build a reusable React component library with TypeScript. Helps when: your team has inconsistent UI patterns, you're starting a new design system, or you need production-ready components.
taxonomy_path: technical/frontend/react-components
content_outline: ["Introduction to Component Libraries", "Project Setup with TypeScript", "Component Design Patterns", "Building Reusable Components", "Testing Components", "Documentation with Storybook", "Publishing and Distribution"]
generation_guidance: Write in a clear, instructional style. Use practical examples. Include TypeScript types. Show both good and bad patterns. Target intermediate developers.
success_criteria: ["All code examples are TypeScript-typed", "Includes 5+ component patterns", "Has testing examples", "Documentation is complete"]
estimated_length: medium
tags: ["react", "typescript", "components", "frontend", "design-system"]
rationale: This plan covers the full lifecycle of building a component library, from setup to publishing."""

    def _mock_questions_response(self):
        return """questions: [
    {"text": "What type of application are you building?", "question_type": "single", "options": [{"id": "web", "label": "Web Application"}, {"id": "mobile", "label": "Mobile App"}, {"id": "desktop", "label": "Desktop App"}], "rationale": "Determines technology stack and constraints", "allows_other": true},
    {"text": "Which programming language do you prefer?", "question_type": "single", "options": [{"id": "typescript", "label": "TypeScript"}, {"id": "javascript", "label": "JavaScript"}, {"id": "python", "label": "Python"}], "rationale": "Language choice affects all implementation details", "allows_other": true}
]
priority: critical
rationale: Need to clarify technology stack and scope before proceeding with skill creation"""

    def _mock_default_response(self):
        return "Default mock response"


