<!-- Chunk 266: bytes 332521-333229, type=function -->
def analyze_file(
    filepath: Path, max_complexity: int = 10, max_length: int = 50
) -> dict[str, Any]:
    """Analyze a single Python file for complexity issues."""
    try:
        with open(filepath, encoding="utf-8") as f:
            source = f.read()

        tree = ast.parse(source, filename=str(filepath))
        analyzer = ComplexityAnalyzer(str(filepath), max_complexity, max_length)
        analyzer.visit(tree)

        return {
            "filepath": str(filepath),
            "issues": analyzer.issues,
        }

    except (SyntaxError, UnicodeDecodeError) as e:
        return {
            "filepath": str(filepath),
            "error": str(e),
            "issues": [],
        }


