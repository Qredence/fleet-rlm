<!-- Chunk 1045: bytes 3763790-3765713, type=function -->
def validate_path_within_root(user_path: Path, root_path: Path, path_type: str) -> Path:
    """Validate user path is within allowed root directory."""
    user_path = user_path.resolve()
    root_path = root_path.resolve()

    try:
        # Check if user_path is within root_path
        user_path.relative_to(root_path)
        return user_path
    except ValueError:
        raise ValueError(
            f"{path_type} path '{user_path}' must be within '{root_path}'"
        )

# Usage in commands:
skills_root = validate_path_within_root(
    Path(args.skills_root),
    Path.cwd() / "skills",  # Default allowed root
    "Skills root"
)
```

### Issue 2: Session File Path Not Sanitized (Medium Severity)

**Location:** `interactive_cli.py:94, 489`

**Problem:**
Session file location is derived from user input without sanitization:

```python
# interactive_cli.py:94
data = json.loads(self.session_file.read_text(encoding="utf-8"))

# interactive_cli.py:489
self.session_file.write_text(
    json.dumps(session_dict, indent=2, default=str), encoding="utf-8"
)
```

**Vulnerability:**
If session file path includes user input (e.g., from `--session` argument), an attacker could:
- Write session data to arbitrary locations
- Overwrite existing files
- Create files in sensitive directories

**Mitigation Required:**
- Validate session file paths are within allowed directory (e.g., `.skill-fleet/`)
- Use `.relative_to()` check before file operations
- Consider using a dedicated cache directory for sessions

---

## Input Validation

### Issue 3: API URLs Not Validated for Protocol (Medium Severity)

**Location:** `app.py:38-43`, `client.py:16-19`

**Problem:**
API URL is accepted from user without protocol validation:

```python
# app.py:38-43
api_url: str = typer.Option(
    "http://localhost:8000",
    "--api-url", "-a",
    help="API server URL",
    envvar="SKILL_FLEET_API_URL"
)

# client.py:16-19
