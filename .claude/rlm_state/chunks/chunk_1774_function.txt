<!-- Chunk 1774: bytes 7420294-7421995, type=function -->
def content_quality_metric(
    gold: dspy.Example,
    pred: dspy.Prediction,
    trace: Any = None,
) -> float:
    """
    Evaluate content generation quality.

    Scoring:
    - Has Overview section: 0.2
    - Has Capabilities section: 0.2
    - Has code examples: 0.3
    - Reasonable length: 0.3

    Args:
        gold: Example (not used for content, just structure)
        pred: Prediction with content.skill_content
        trace: Optional trace information

    Returns:
        Score between 0.0 and 1.0

    """
    if isinstance(pred, dict):
        content_data = pred.get("content")
    else:
        content_data = getattr(pred, "content", None)

    if content_data is None:
        return 0.0

    if isinstance(content_data, dict):
        content = content_data.get("skill_content", "")
    else:
        content = getattr(content_data, "skill_content", "")

    if not content:
        return 0.0

    score = 0.0

    # Has Overview section
    if "## Overview" in content or "## overview" in content.lower():
        score += 0.2

    # Has Capabilities section
    if "## Capabilities" in content or "## capabilities" in content.lower():
        score += 0.2

    # Has code examples
    code_blocks = content.count("```")
    if code_blocks >= 4:  # At least 2 complete blocks
        score += 0.3
    elif code_blocks >= 2:
        score += 0.2
    elif code_blocks >= 1:
        score += 0.1

    # Reasonable length (500-3000 words is ideal)
    word_count = len(content.split())
    if 500 <= word_count <= 3000:
        score += 0.3
    elif 300 <= word_count <= 5000:
        score += 0.2
    elif word_count >= 200:
        score += 0.1

    return min(score, 1.0)


