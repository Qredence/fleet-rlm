<!-- Chunk 987: bytes 3446681-3450686, type=function -->
def validate_command(
    skill_path: str = typer.Argument(..., help="Path to a skill directory or JSON file"),
    skills_root: str = typer.Option(
        str(default_skills_root()), "--skills-root", help="Skills taxonomy root"
    ),
    json_output: bool = typer.Option(False, "--json", help="Output JSON only"),
) -> None:
    """Validate a skill's metadata and structure.

    Checks for:
    - Required files (skill.md, skill.py, __init__.py)
    - Valid YAML frontmatter with name and description
    - agentskills.io compliance

    \b
    Example:
        skill-fleet validate skills/general/testing
        skill-fleet validate skills/general/testing --json
    """
    try:
        skills_root_path = Path(skills_root).resolve()

        # Resolve and validate skill path is within skills root
        skill_path_resolved = Path(skill_path)
        if not skill_path_resolved.is_absolute():
            skill_path_resolved = skills_root_path / skill_path_resolved

        # Security: Validate path doesn't escape root
        try:
            skill_path_resolved = validate_path_within_root(
                skill_path_resolved, skills_root_path, "Skill path"
            )
        except ValueError as e:
            raise ValidationError(str(e))

        validator = SkillValidator(skills_root_path)
        results = validator.validate_complete(skill_path_resolved)

        if json_output:
            print(json.dumps(results, indent=2))
            if not results.get("passed"):
                raise typer.Exit(code=EXIT_VALIDATION_ERROR)
            return

        # Human-readable output
        status = "passed" if results.get("passed") else "failed"
        if results.get("passed"):
            display_success(f"Validation passed: {skill_path_resolved}")
        else:
            display_error(f"Validation failed: {skill_path_resolved}")

        if results.get("errors"):
            console.print("\n[bold red]Errors:[/bold red]")
            for message in results["errors"]:
                console.print(f"  [red]•[/red] {message}")

        if results.get("warnings"):
            console.print("\n[bold yellow]Warnings:[/bold yellow]")
            for message in results["warnings"]:
                console.print(f"  [yellow]•[/yellow] {message}")

        if not results.get("passed"):
            raise typer.Exit(code=EXIT_VALIDATION_ERROR)

    except ValidationError:
        raise
    except Exception as e:
        display_error(f"Validation error: {e}")
        raise typer.Exit(code=1)
```

**Step 4: Run tests**

```bash
uv run pytest tests/cli/test_validate_command.py -v
```

**Step 5: Commit**

```bash
git add src/skill_fleet/cli/commands/validate.py tests/cli/test_validate_command.py
git commit -m "feat(cli): add path validation to validate command

- Add validate_path_within_root check to prevent traversal
- Use singleton console from utils
- Use display_success/display_error for consistent formatting
- Add ValidationError for validation failures
- Improve help text with examples

Fixes security issue from cli-security-review.md"
```

---

## Task 8: Update Remaining Commands with Error Handling

**Files:**
- Modify: `src/skill_fleet/cli/commands/*.py` (remaining files)
- Create: `tests/cli/test_remaining_commands.py`

**Step 1: Update all remaining command files**

For each remaining command file (`list_skills.py`, `serve.py`, `chat.py`, `analytics.py`, `migrate.py`, `generate_xml.py`, `optimize.py`, `onboard.py`):

1. Replace `Console()` with `get_console()`
2. Replace bare `except Exception` with specific exceptions
3. Add proper cleanup in `finally` blocks
4. Use display functions for consistent formatting

**Step 2: Example update for list_skills.py**

Modify `src/skill_fleet/cli/commands/list_skills.py`:

```python
"""CLI command for listing skills."""

from __future__ import annotations

import asyncio

import typer

from ...utils.console import get_console
from ...exceptions import APIError

console = get_console()


