<!-- Chunk 1266: bytes 4702051-4703953, type=function -->
def cmd_compare(args: argparse.Namespace) -> int:
    """Compare baseline vs optimized program."""
    try:
        optimizer = SkillOptimizer()

        # Load optimized program
        from skill_fleet.core.dspy.skill_creator import SkillCreationProgram

        # Baseline comparisons must not auto-load optimized weights, otherwise the
        # "baseline vs optimized" evaluation becomes misleading whenever
        # config/optimized/* exists.
        baseline = SkillCreationProgram(
            quality_assured=True,
            hitl_enabled=False,
            load_optimized=False,
        )
        optimized = optimizer.load_optimized_program(args.program, SkillCreationProgram)

        if optimized is None:
            logger.error(f"Could not load optimized program: {args.program}")
            return 1

        # Load test set
        from skill_fleet.core.dspy.training import load_testset

        testset = load_testset(min_quality=0.6)

        if not testset:
            logger.error("No test examples available")
            return 1

        # Compare
        comparison = optimizer.evaluator.compare_programs(baseline, optimized, testset)

        print(f"\n{'=' * 60}")
        print("PROGRAM COMPARISON")
        print(f"{'=' * 60}")
        print(f"\nBaseline Score: {comparison['baseline']['score']:.3f}")
        print(f"Optimized Score: {comparison['optimized']['score']:.3f}")
        print(
            f"\nImprovement: {comparison['improvement']['absolute']:+.3f} ({comparison['improvement']['percentage']:+.1f}%)"
        )
        print(f"Additional Passed: {comparison['improvement']['additional_passed']}")
        print(f"\n{'=' * 60}")

        if args.json:
            print("\nJSON Output:")
            print(json.dumps(comparison, indent=2))

        return 0

    except Exception as e:
        logger.error(f"Comparison failed: {e}")
        return 1


