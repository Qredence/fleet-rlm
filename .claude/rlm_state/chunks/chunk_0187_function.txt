<!-- Chunk 187: bytes 291113-292347, type=function -->
def test_process_user(sample_user):
    result = process_user(sample_user)
    assert result.status == "processed"
```

## Database Best Practices

### Use ORMs Properly

**Good:**
```python
# Eager loading to avoid N+1
users = session.query(User).options(
    joinedload(User.orders)
).all()

for user in users:
    print(user.orders)  # No additional queries
```

**Bad:**
```python
# N+1 query problem
users = session.query(User).all()

for user in users:
    print(user.orders)  # Fires a query for each user!
```

### Connection Management

**Good:**
```python
from contextlib import asynccontextmanager

@asynccontextmanager
async def get_db():
    async with SessionLocal() as session:
        try:
            yield session
            await session.commit()
        except Exception:
            await session.rollback()
            raise
```

## API Design

### RESTful Endpoints

```python
# Good RESTful design
GET    /api/users           # List users
GET    /api/users/{id}      # Get specific user
POST   /api/users           # Create user
PUT    /api/users/{id}      # Update user
DELETE /api/users/{id}      # Delete user
```

### Input Validation

**Good:**
```python
from pydantic import BaseModel, EmailStr, Field

