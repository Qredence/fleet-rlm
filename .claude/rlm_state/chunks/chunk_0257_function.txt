<!-- Chunk 257: bytes 315154-317835, type=function -->
def get_active_user_emails(users):
    return [
        user.email
        for user in users
        if user.is_active and user.email
    ]
```

## Improve Import Organization

### Pattern: Group and Sort Imports

**Before:**
```python
from myapp.utils import helper
import sys
from typing import List
import os
from myapp.models import User
import json
```

**After:**
```python
# Standard library
import json
import os
import sys
from typing import List

# Local imports
from myapp.models import User
from myapp.utils import helper
```

### Pattern: Replace Wildcard Imports

**Before:**
```python
from utils import *
from models import *

# Which module does User come from?
user = User()
```

**After:**
```python
from utils import validate_email, format_date
from models import User, Product

user = User()  # Clear origin
```

## Refactoring Workflow

1. **Ensure tests exist** - Before refactoring, write tests if they don't exist
2. **Make small changes** - Refactor incrementally, not all at once
3. **Run tests frequently** - After each small change, verify nothing broke
4. **Commit often** - Commit after each successful refactoring step
5. **Use tools** - Leverage IDE refactoring tools when available

## When to Refactor

✅ **DO refactor when:**
- Adding a new feature that reveals code smells
- Fixing a bug caused by unclear code
- Code review identifies issues
- You find yourself copy-pasting code

❌ **DON'T refactor when:**
- You're close to a deadline
- Tests don't exist and are hard to add
- The code works and won't be modified again
- Refactoring would break public APIs

## Refactoring Checklist

- [ ] Tests pass before refactoring
- [ ] Make one small change at a time
- [ ] Tests still pass after refactoring
- [ ] Code is more readable than before
- [ ] No functionality changed
- [ ] Performance is the same or better
- [ ] All imports still resolve correctly
- [ ] Type hints are accurate


============================================================
END FILE: .fleet/factory/skills/python-backend-reviewer/references/refactoring_patterns.md
============================================================

============================================================
FILE: .fleet/factory/skills/python-backend-reviewer/scripts/analyze_imports.py
============================================================

#!/usr/bin/env python3
"""
Analyze imports and detect recreated utility functions that should be imports.

Usage:
    python analyze_imports.py <file_or_directory>
    python analyze_imports.py --check-utils <file_or_directory>
"""

import ast
import sys
from collections import defaultdict
from pathlib import Path
from typing import Any


