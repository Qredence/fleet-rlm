<!-- Chunk 2087: bytes 8009465-8011689, type=class -->
class TestPromptToolkitUI:
    @pytest.mark.asyncio
    async def test_choose_one_returns_selected_id(self, monkeypatch):
        # Arrange
        monkeypatch.setattr(
            "prompt_toolkit.shortcuts.choice",
            lambda *_, **__: "b",
        )

        ui = PromptToolkitUI()

        # Act
        selected = await ui.choose_one("Pick one", [("a", "A"), ("b", "B")], default_id="a")

        # Assert
        assert selected == "b"

    @pytest.mark.asyncio
    async def test_choose_one_cancel_falls_back_to_default(self, monkeypatch):
        # Arrange
        monkeypatch.setattr(
            "prompt_toolkit.shortcuts.choice",
            lambda *_, **__: None,
        )

        ui = PromptToolkitUI()

        # Act
        selected = await ui.choose_one("Pick one", [("a", "A"), ("b", "B")], default_id="b")

        # Assert
        assert selected == "b"

    @pytest.mark.asyncio
    async def test_choose_many_returns_selected_ids(self, monkeypatch):
        # Arrange
        class _Dialog:
            async def run_async(self):
                return ["a", "c"]

        def _check(**_kwargs):
            return _Dialog()

        monkeypatch.setattr("prompt_toolkit.shortcuts.checkboxlist_dialog", _check)

        ui = PromptToolkitUI()

        # Act
        selected = await ui.choose_many("Pick many", [("a", "A"), ("b", "B"), ("c", "C")])

        # Assert
        assert selected == ["a", "c"]

    @pytest.mark.asyncio
    async def test_choose_one_radiolist_dialog_returns_selected_id(self, monkeypatch):
        # Arrange: simulate radiolist_dialog returning a dialog with run_async()
        class _Dialog:
            async def run_async(self):
                return "b"

        def _radiolist(**_kwargs):
            return _Dialog()

        # Ensure the `choice` helper is not used so the radiolist path is taken.
        monkeypatch.setattr("prompt_toolkit.shortcuts.choice", None, raising=False)
        monkeypatch.setattr("prompt_toolkit.shortcuts.radiolist_dialog", _radiolist)

        ui = PromptToolkitUI()

        # Act
        selected = await ui.choose_one("Pick one", [("a", "A"), ("b", "B")], default_id="a")

        # Assert
        assert selected == "b"


