<!-- Chunk 261: bytes 323273-324154, type=function -->
def analyze_file(filepath: Path) -> dict[str, Any]:
    """Analyze a single Python file for import and utility issues."""
    try:
        with open(filepath, encoding="utf-8") as f:
            source = f.read()

        tree = ast.parse(source, filename=str(filepath))
        analyzer = ImportAnalyzer(str(filepath))
        analyzer.visit(tree)

        import_issues = check_import_organization(analyzer)
        utility_issues = detect_utility_reimplementation(analyzer)

        return {
            "filepath": str(filepath),
            "imports_count": len(analyzer.imports),
            "functions_count": len(analyzer.functions),
            "issues": import_issues + utility_issues,
        }

    except (SyntaxError, UnicodeDecodeError) as e:
        return {
            "filepath": str(filepath),
            "error": str(e),
            "issues": [],
        }


