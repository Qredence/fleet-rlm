<!-- Chunk 2023: bytes 7907493-7909390, type=class -->
class TestSanitizeRelativeFilePath:
    """Tests for sanitize_relative_file_path function."""

    def test_accepts_valid_relative_path(self):
        """Test that valid relative paths are accepted."""
        assert sanitize_relative_file_path("path/to/file.txt") == "path/to/file.txt"
        assert sanitize_relative_file_path("subdir/file.py") == "subdir/file.py"

    def test_rejects_absolute_path(self):
        """Test that absolute paths are rejected."""
        assert sanitize_relative_file_path("/absolute/path") is None
        assert sanitize_relative_file_path("/etc/passwd") is None

    def test_rejects_parent_directory_traversal(self):
        """Test that parent directory traversal is rejected."""
        assert sanitize_relative_file_path("../file.txt") is None
        assert sanitize_relative_file_path("path/../../escape") is None

    def test_rejects_windows_separators(self):
        """Test that Windows separators are rejected."""
        assert sanitize_relative_file_path("path\\to\\file") is None

    def test_rejects_null_bytes(self):
        """Test that null bytes are rejected."""
        assert sanitize_relative_file_path("path\x00file") is None

    def test_rejects_empty_path(self):
        """Test that empty paths are rejected."""
        assert sanitize_relative_file_path("") is None

    def test_accepts_dots_in_filenames(self):
        """Test that dots in filenames are accepted."""
        assert sanitize_relative_file_path("file.name.txt") == "file.name.txt"
        assert sanitize_relative_file_path("path/to/.hidden") == "path/to/.hidden"

    def test_normalizes_path_segments(self):
        """Test that path segments are normalized."""
        # Removes empty segments and single dots
        assert sanitize_relative_file_path("path//double") == "path/double"
        assert sanitize_relative_file_path("./path/file") == "path/file"


