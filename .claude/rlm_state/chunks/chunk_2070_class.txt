<!-- Chunk 2070: bytes 7976431-7978213, type=class -->
class TestAnalyzeIntentModule:
    """Test AnalyzeIntentModule."""

    def test_module_can_be_instantiated(self):
        """Should create instance with ChainOfThought."""
        module = AnalyzeIntentModule()
        assert module is not None
        assert hasattr(module, "analyze")

    @patch("skill_fleet.core.modules.understanding.intent.dspy.ChainOfThought")
    def test_forward_returns_structured_output(self, mock_cot):
        """Should return dict with intent components."""
        mock_result = Mock()
        mock_result.purpose = "Learn React"
        mock_result.problem_statement = "Need UI components"
        mock_result.target_audience = "Frontend devs"
        mock_result.value_proposition = "Pre-built components"
        mock_result.skill_type = "how_to"
        mock_result.scope = "Component creation"
        mock_result.success_criteria = ["Can create components"]

        mock_cot.return_value.return_value = mock_result

        module = AnalyzeIntentModule()
        result = module.forward(
            task_description="Build a React component library", requirements={"domain": "technical"}
        )

        assert isinstance(result, dict)
        assert result["purpose"] == "Learn React"
        assert result["skill_type"] == "how_to"
        assert "success_criteria" in result

    @pytest.mark.skip(reason="Integration test - requires actual LM configuration")
    def test_forward_handles_missing_requirements(self):
        """Should handle None requirements gracefully."""
        module = AnalyzeIntentModule()

        # Integration test - requires actual LM
        result = module.forward(task_description="Create a Python function", requirements=None)

        assert "purpose" in result
        assert "skill_type" in result


