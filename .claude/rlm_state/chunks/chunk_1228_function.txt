<!-- Chunk 1228: bytes 4616914-4619743, type=function -->
def main():
    """Main function to regenerate training data."""
    skills_dir = Path(".skills")
    if not skills_dir.exists():
        print("Error: .skills directory not found")
        return

    gold_skills = []
    trainset = []

    print("Processing .skills golden examples...")
    for item in sorted(skills_dir.iterdir()):
        if item.is_dir():
            # Check for nested skills (like neon-db/)
            nested_skills = [d for d in item.iterdir() if d.is_dir() and (d / "SKILL.md").exists()]
            if nested_skills:
                # Process nested skills
                for nested in nested_skills:
                    print(f"  Processing nested: {item.name}/{nested.name}")
                    skill_data = process_skill_directory(nested)
                    if skill_data:
                        skill_data["skill_id"] = f".skills/{item.name}/{nested.name}"
                        skill_data["skill_path"] = f".skills/{item.name}/{nested.name}/SKILL.md"
                        gold_skills.append(skill_data)
                        trainset.append(generate_trainset_entry(skill_data))
            elif (item / "SKILL.md").exists():
                # Process top-level skill
                print(f"  Processing: {item.name}")
                skill_data = process_skill_directory(item)
                if skill_data:
                    gold_skills.append(skill_data)
                    trainset.append(generate_trainset_entry(skill_data))

    # Save gold_skills.json
    gold_output = {
        "version": "2.0",
        "description": "Golden skill examples extracted from .skills/ directory",
        "skills": gold_skills,
    }
    with open("config/training/gold_skills_v2.json", "w") as f:
        json.dump(gold_output, f, indent=2)
    print(f"\nGenerated config/training/gold_skills_v2.json with {len(gold_skills)} skills")

    # Save trainset_v2.json
    with open("config/training/trainset_v2.json", "w") as f:
        json.dump(trainset, f, indent=2)
    print(f"Generated config/training/trainset_v2.json with {len(trainset)} examples")


if __name__ == "__main__":
    main()


============================================================
END FILE: scripts/internal/data/regenerate_training_data.py
============================================================

============================================================
FILE: scripts/internal/db/generate_taxonomy_index.py
============================================================

"""
Generate the taxonomy_index.json from the taxonomy mapping report.

This script parses reports/taxonomy-map.md and converts it into the
skills/taxonomy_index.json format using the new TaxonomyIndex models.
"""

import logging
from pathlib import Path

from skill_fleet.taxonomy.models import CategoryNode, SkillEntry, TaxonomyIndex


