<!-- Chunk 1587: bytes 6545283-6545689, type=function -->
def _derive_api_url(host: str, port: int, configured_api_url: str | None) -> str:
    """Derive the API URL, honoring configured value when provided."""
    if configured_api_url and configured_api_url != "http://localhost:8000":
        return configured_api_url

    resolved_host = host
    if host in {"0.0.0.0", "::"}:
        resolved_host = "127.0.0.1"
    return f"http://{resolved_host}:{port}"


