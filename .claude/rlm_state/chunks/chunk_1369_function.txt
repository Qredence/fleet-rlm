<!-- Chunk 1369: bytes 5074713-5075823, type=function -->
def process_video(video_id: str):
    # Long-running video processing
    result = video_processor.process(video_id)
    return {"video_id": video_id, "result": result}

# FastAPI integration
@app.post("/videos/{video_id}/process")
async def process_video_endpoint(video_id: str):
    task = process_video.delay(video_id)
    return {
        "task_id": task.id,
        "status": "processing"
    }

@app.get("/tasks/{task_id}")
async def get_task_status(task_id: str):
    result = celery_app.AsyncResult(task_id)
    return {
        "task_id": task_id,
        "status": result.state,
        "result": result.result if result.ready() else None
    }
```

## Comparison: BackgroundTasks vs Celery

| Feature | BackgroundTasks | Celery |
|---------|-----------------|--------|
| Setup complexity | Simple | Complex |
| Distributed execution | ❌ No | ✅ Yes |
| Task persistence | ❌ Lost on restart | ✅ Persistent |
| Retry logic | Manual | Built-in |
| Scheduling | ❌ No | ✅ Yes |
| Monitoring | ❌ No | ✅ Flower UI |
| Best for | Simple fire-and-forget | Production workloads |

## Error Handling

```python
