<!-- Chunk 1130: bytes 4243818-4244867, type=function -->
def test_dspy_version_is_3_1_plus():
    # DSPy 3.1.x introduces dspy.Reasoning type behavior used by our integration.
    assert hasattr(dspy, "Reasoning"), "DSPy >= 3.1.1 required (missing dspy.Reasoning)"
```

**Step 2: Run test to verify it fails**

Run: `uv run pytest tests/unit/test_dspy_version_guard.py -v`
Expected: FAIL if local env is still on DSPy < 3.1.1.

**Step 3: Minimal implementation**

Update `pyproject.toml` dependency from:

`"dspy>=3.0.4",`

to:

`"dspy>=3.1.2,<4",`

**Step 4: Sync environment**

Run: `uv sync --group dev`
Expected: installs DSPy 3.1.2 (or newer 3.1.x) satisfying constraint.

**Step 5: Run test to verify it passes**

Run: `uv run pytest tests/unit/test_dspy_version_guard.py -v`
Expected: PASS

---

### Task 2: Introduce a safe coercion utility for `dspy.Reasoning`

**Files:**
- Create: `src/skill_fleet/common/dspy_compat.py`
- Test: `tests/unit/test_dspy_reasoning_compat.py`

**Step 1: Write failing test**

```python
import dspy

from skill_fleet.common.dspy_compat import coerce_reasoning_text


