<!-- Chunk 1238: bytes 4645439-4647358, type=class -->
class ComprehensiveFunctionVisitor(ast.NodeVisitor):
    """Comprehensive AST visitor to find functions and check for docstrings."""

    def __init__(self):
        self.functions: list[dict] = []
        self.current_class = None

    def visit_FunctionDef(self, node):
        """Visit function definition nodes and collect metadata."""
        # Skip private functions (starting with underscore)
        if not node.name.startswith("_"):
            has_docstring = ast.get_docstring(node) is not None
            is_async = False
            self.functions.append(
                {
                    "name": node.name,
                    "line": node.lineno,
                    "has_docstring": has_docstring,
                    "is_async": is_async,
                    "is_method": self.current_class is not None,
                    "class_name": self.current_class,
                }
            )
        self.generic_visit(node)

    def visit_AsyncFunctionDef(self, node):
        """Visit async function definition nodes and collect metadata."""
        # Handle async functions the same way
        if not node.name.startswith("_"):
            has_docstring = ast.get_docstring(node) is not None
            is_async = True
            self.functions.append(
                {
                    "name": node.name,
                    "line": node.lineno,
                    "has_docstring": has_docstring,
                    "is_async": is_async,
                    "is_method": self.current_class is not None,
                    "class_name": self.current_class,
                }
            )
        self.generic_visit(node)

    def visit_ClassDef(self, node):
        """Visit class definition nodes and set current class context."""
        old_class = self.current_class
        self.current_class = node.name
        self.generic_visit(node)
        self.current_class = old_class


