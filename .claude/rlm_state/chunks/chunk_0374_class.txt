<!-- Chunk 374: bytes 564229-564796, type=class -->
class MapReduceProcessor(dspy.Module):
    def __init__(self):
        super().__init__()
        self.map = dspy.Predict(MapSignature)
        self.reduce = dspy.Predict(ReduceSignature)

    def forward(self, items: list[str]):
        # Map: Process each item
        mapped_results = [self.map(item=item) for item in items]

        # Reduce: Aggregate results
        aggregated = self.reduce(results=[r.output for r in mapped_results])

        return dspy.Prediction(output=aggregated.output)
```

### 2. Refine Pattern

Iteratively improve output:

```python
