<!-- Chunk 1582: bytes 6540684-6542318, type=function -->
def status() -> None:
    """
    Check database connection and table status.

    Verifies that the database is accessible and all required
    tables exist.
    """
    from skill_fleet.infrastructure.db.database import SessionLocal
    from skill_fleet.infrastructure.db.models import HITLInteraction, Job, Skill, TaxonomyCategory

    try:
        session = SessionLocal()
        try:
            # Check connection
            session.execute(text("SELECT 1"))
            logger.info("✅ Database connection OK")

            # Check tables
            tables_to_check = [
                ("skills", Skill),
                ("jobs", Job),
                ("hitl_interactions", HITLInteraction),
                ("taxonomy_categories", TaxonomyCategory),
            ]

            all_ok = True
            for table_name, model_class in tables_to_check:
                try:
                    count = session.query(model_class).count()
                    typer.echo(f"  ✅ {table_name:30s} ({count:4d} rows)")
                except Exception as e:
                    typer.echo(f"  ❌ {table_name:30s} (error: {str(e)[:50]})")
                    all_ok = False

            if all_ok:
                typer.echo("\n✅ Database status: OK\n")
            else:
                typer.echo("\n⚠️  Database status: Some tables missing\n")
                raise typer.Exit(1)

        finally:
            session.close()

    except Exception as e:
        logger.error(f"Database health check failed: {e}", exc_info=True)
        typer.echo(f"\n❌ Error: {e}\n", err=True)
        raise typer.Exit(1) from e


@db_app.command()
