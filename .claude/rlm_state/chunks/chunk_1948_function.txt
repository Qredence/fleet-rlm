<!-- Chunk 1948: bytes 7802876-7804478, type=function -->
def load_skill_dir_metadata(skill_dir: Path) -> SkillMetadata:
    """
    Load a skill definition stored as a directory containing `metadata.json`.

    Also attempts to parse YAML frontmatter from SKILL.md for agentskills.io
    compliant skills.

    Args:
        skill_dir: Path to the skill directory

    Returns:
        SkillMetadata object containing the skill's metadata

    """
    metadata_path = skill_dir / "metadata.json"
    skill_data = json.loads(metadata_path.read_text(encoding="utf-8"))
    skill_id = skill_data["skill_id"]

    # Try to get name/description from SKILL.md frontmatter first
    skill_md_path = skill_dir / "SKILL.md"
    frontmatter = {}
    if skill_md_path.exists():
        frontmatter = parse_skill_frontmatter(skill_md_path)

    # Use frontmatter values, fall back to metadata.json, then generate
    name = frontmatter.get("name") or skill_data.get("name") or skill_id_to_name(skill_id)
    description = frontmatter.get("description") or skill_data.get("description", "")

    metadata = SkillMetadata(
        skill_id=skill_id,
        version=skill_data.get("version", "1.0.0"),
        type=skill_data.get("type", "technical"),
        weight=skill_data.get("weight", "medium"),
        load_priority=skill_data.get("load_priority", "on_demand"),
        dependencies=list(skill_data.get("dependencies", [])),
        capabilities=list(skill_data.get("capabilities", [])),
        path=metadata_path,
        always_loaded=bool(skill_data.get("always_loaded", False)),
        name=name,
        description=description,
    )
    return metadata


