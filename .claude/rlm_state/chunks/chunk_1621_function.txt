<!-- Chunk 1621: bytes 6656748-6657738, type=function -->
def sanitize_user_id(user_id: str) -> str:
    """
    Sanitize user ID to prevent injection attacks.

    Only allows alphanumeric characters, hyphens, underscores, @, and periods.

    Args:
        user_id: The user ID to sanitize

    Returns:
        The sanitized user ID

    Raises:
        ValueError: If the user ID contains invalid characters or has invalid length
    """
    if not user_id:
        raise ValueError("User ID cannot be empty")

    # Remove dangerous characters
    sanitized = re.sub(r"[^\w\-@.]", "", user_id)

    # Check if characters were removed
    if sanitized != user_id:
        raise ValueError(
            f"User ID contains invalid characters. "
            f"Only alphanumeric, hyphen, underscore, @, and period are allowed. Got: {user_id}"
        )

    # Validate length
    if len(sanitized) < 1 or len(sanitized) > 100:
        raise ValueError(f"User ID must be between 1 and 100 characters. Got: {len(sanitized)}")

    return sanitized


