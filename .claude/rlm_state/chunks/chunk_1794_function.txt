<!-- Chunk 1794: bytes 7470158-7472133, type=function -->
def skill_content_reward(args, pred: dspy.Prediction) -> float:
    """
    Score skill content quality (SKILL.md generation).

    Checks:
    - Required sections present (Overview, Capabilities, etc.)
    - Has code examples (``` blocks)
    - Reasonable length (500-5000 words)
    - Proper formatting

    Returns:
        float: Score between 0.0 and 1.0

    """
    score = 0.0

    try:
        content = getattr(pred, "skill_content", "")
        if not isinstance(content, str) or not content:
            return 0.0

        # Required sections present
        required_sections = [
            "# ",  # Title
            "## Overview",
            "## Capabilities",
            "## Dependencies",
            "## Usage Examples",
        ]
        section_score = sum(1 for section in required_sections if section in content)
        score += (section_score / len(required_sections)) * 0.4

        # Has code examples
        code_blocks = content.count("```")
        if code_blocks >= 4:  # At least 2 complete code blocks
            score += 0.2
        elif code_blocks >= 2:
            score += 0.15
        elif code_blocks >= 1:
            score += 0.1

        # Reasonable length (500-5000 words)
        word_count = len(content.split())
        if 800 <= word_count <= 3000:
            score += 0.2
        elif 500 <= word_count <= 5000:
            score += 0.15
        elif word_count >= 300:
            score += 0.1

        # Has proper markdown formatting
        formatting_elements = [
            r"\*\*.*?\*\*",  # Bold
            r"- ",  # Lists
            r"\d+\. ",  # Numbered lists
            r"###",  # Subsections
        ]
        format_count = sum(1 for pattern in formatting_elements if re.search(pattern, content))
        score += (format_count / len(formatting_elements)) * 0.2

    except Exception as e:
        logger.warning(f"Error in skill_content_reward: {e}")
        return 0.0

    return min(score, 1.0)


