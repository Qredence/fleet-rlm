<!-- Chunk 1952: bytes 7811486-7813083, type=function -->
def generate_skill_md_with_frontmatter(
    name: str,
    description: str,
    metadata: dict[str, Any],
    content: str,
) -> str:
    """
    Generate SKILL.md content with agentskills.io compliant YAML frontmatter.

    Args:
        name: Kebab-case skill name
        description: Skill description (1-1024 chars)
        metadata: Extended metadata dict
        content: Original markdown content (may or may not have frontmatter)

    Returns:
        Complete SKILL.md content with proper frontmatter

    """
    # Strip existing frontmatter from content if present
    body_content = content
    if content.startswith("---"):
        end_marker = content.find("---", 3)
        if end_marker != -1:
            body_content = content[end_marker + 3 :].lstrip("\n")

    # Build frontmatter
    frontmatter = {
        "name": name,
        "description": description[:1024],  # Enforce max length
    }

    # Add optional extended metadata
    extended_meta = {}
    if metadata.get("skill_id"):
        extended_meta["skill_id"] = metadata["skill_id"]
    if metadata.get("version"):
        extended_meta["version"] = metadata["version"]
    if metadata.get("type"):
        extended_meta["type"] = metadata["type"]
    if metadata.get("weight"):
        extended_meta["weight"] = metadata["weight"]

    if extended_meta:
        frontmatter["metadata"] = extended_meta

    # Generate YAML frontmatter
    yaml_content = yaml.dump(
        frontmatter, default_flow_style=False, allow_unicode=True, sort_keys=False
    )

    return f"---\n{yaml_content}---\n\n{body_content}"


