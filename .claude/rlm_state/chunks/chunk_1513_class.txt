<!-- Chunk 1513: bytes 6364570-6367115, type=class -->
class JobState(BaseModel):
    """Represents the current state of a background job."""

    model_config = ConfigDict(arbitrary_types_allowed=True)

    job_id: str
    status: str = "pending"
    task_description: str = ""
    hitl_type: str | None = None
    hitl_data: dict[str, Any] | None = None
    hitl_response: dict[str, Any] | None = None
    result: Any | None = None
    error: str | None = None

    hitl_event: asyncio.Event | None = None
    hitl_lock: asyncio.Lock | None = None

    current_phase: str | None = None
    progress_message: str | None = None

    intended_taxonomy_path: str | None = None
    draft_path: str | None = None
    final_path: str | None = None
    promoted: bool = False

    validation_passed: bool | None = None
    validation_status: str | None = None
    validation_score: float | None = None

    saved_path: str | None = None

    tdd_workflow: TDDWorkflowState = Field(default_factory=TDDWorkflowState)
    deep_understanding: DeepUnderstandingState = Field(default_factory=DeepUnderstandingState)
    multi_skill_queue: list[str] = Field(default_factory=list)
    current_skill_index: int = 0
    task_description_refined: str = ""

    created_at: datetime = Field(default_factory=lambda: datetime.now(UTC))
    updated_at: datetime = Field(default_factory=lambda: datetime.now(UTC))

    user_id: str = "default"
    user_context: dict[str, Any] = Field(default_factory=dict)

    @field_serializer("hitl_event", "hitl_lock", when_used="json")
    def serialize_sync_objects(self, value: Any) -> None:
        """Exclude asyncio sync objects from JSON serialization."""
        return None

    @model_validator(mode="after")
    def initialize_hitl_sync_objects(self) -> JobState:
        """Initialize asyncio sync objects for HITL synchronization."""
        if self.hitl_event is None:
            object.__setattr__(self, "hitl_event", asyncio.Event())
        if self.hitl_lock is None:
            object.__setattr__(self, "hitl_lock", asyncio.Lock())
        return self


============================================================
END FILE: src/skill_fleet/api/schemas/models.py
============================================================

============================================================
FILE: src/skill_fleet/api/schemas/optimization.py
============================================================

"""Pydantic schemas for signature optimization API endpoints."""

from __future__ import annotations

from typing import Any

from pydantic import BaseModel, Field


