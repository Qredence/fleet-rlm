<!-- Chunk 1368: bytes 5073463-5074713, type=class -->
class Task(Base):
    __tablename__ = "tasks"

    id = Column(String, primary_key=True)
    status = Column(String, default="pending")
    result = Column(JSON, nullable=True)
    error = Column(String, nullable=True)
    created_at = Column(DateTime, default=datetime.utcnow)
    completed_at = Column(DateTime, nullable=True)

# Task function
async def process_task_async(task_id: str, db: AsyncSession):
    async with AsyncSession(engine) as session:
        try:
            # Update status
            task = await session.get(Task, task_id)
            task.status = "processing"
            await session.commit()

            # Do work
            result = await heavy_computation()

            # Update completion
            task.status = "completed"
            task.result = result
            task.completed_at = datetime.utcnow()
            await session.commit()

        except Exception as e:
            task.status = "failed"
            task.error = str(e)
            await session.commit()
```

### 4. Celery for Production (Recommended)

```python
# celery_app.py
from celery import Celery

celery_app = Celery(
    "tasks",
    broker="redis://localhost:6379/0",
    backend="redis://localhost:6379/0"
)

@celery_app.task
