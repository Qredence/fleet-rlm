<!-- Chunk 2022: bytes 7904922-7907493, type=class -->
class TestSanitizeTaxonomyPath:
    """Tests for sanitize_taxonomy_path function."""

    def test_accepts_valid_taxonomy_path(self):
        """Test that valid taxonomy paths are accepted."""
        assert (
            sanitize_taxonomy_path("technical_skills/programming/python")
            == "technical_skills/programming/python"
        )
        assert sanitize_taxonomy_path("general/testing") == "general/testing"
        assert sanitize_taxonomy_path("business/analytics") == "business/analytics"

    def test_rejects_absolute_path(self):
        """Test that absolute paths are rejected."""
        assert sanitize_taxonomy_path("/absolute/path") is None
        assert sanitize_taxonomy_path("/etc/passwd") is None

    def test_rejects_parent_directory_traversal(self):
        """Test that parent directory traversal is rejected."""
        assert sanitize_taxonomy_path("../traversal") is None
        assert sanitize_taxonomy_path("path/../up") is None
        assert sanitize_taxonomy_path("../../etc/passwd") is None

    def test_rejects_windows_separators(self):
        """Test that Windows path separators are rejected."""
        assert sanitize_taxonomy_path("path\\to\\file") is None
        assert sanitize_taxonomy_path("C:\\Windows\\System32") is None

    def test_rejects_empty_path(self):
        """Test that empty paths are rejected."""
        assert sanitize_taxonomy_path("") is None
        assert sanitize_taxonomy_path("   ") is None

    def test_rejects_special_characters(self):
        """Test that paths with special characters are rejected."""
        assert sanitize_taxonomy_path("path/with spaces") is None
        assert sanitize_taxonomy_path("path/with@symbol") is None
        assert sanitize_taxonomy_path("path/with!exclamation") is None

    def test_normalizes_path_segments(self):
        """Test that path segments are normalized."""
        # Removes empty segments and dots
        assert sanitize_taxonomy_path("path//double/slash") == "path/double/slash"
        assert sanitize_taxonomy_path("./current/path") == "current/path"
        assert sanitize_taxonomy_path("path/./middle") == "path/middle"

    def test_accepts_hyphens_and_underscores(self):
        """Test that hyphens and underscores are accepted."""
        assert (
            sanitize_taxonomy_path("python-advanced/web_development")
            == "python-advanced/web_development"
        )
        assert (
            sanitize_taxonomy_path("data-science/machine_learning")
            == "data-science/machine_learning"
        )


