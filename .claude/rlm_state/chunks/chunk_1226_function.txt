<!-- Chunk 1226: bytes 4613865-4615731, type=function -->
def process_skill_directory(skill_dir: Path) -> dict[str, Any] | None:
    """Process a single skill directory and extract data."""
    skill_md = skill_dir / "SKILL.md"
    if not skill_md.exists():
        return None

    content = skill_md.read_text()
    frontmatter, body = extract_frontmatter(content)

    if not frontmatter.get("name"):
        print(f"  Skipping {skill_dir.name}: Missing name in frontmatter")
        return None

    # Collect subdirectory files
    subdirs: dict[str, list[str]] = {}
    for subdir_name in ["references", "guides", "templates", "scripts", "examples"]:
        subdir_path = skill_dir / subdir_name
        if subdir_path.exists() and subdir_path.is_dir():
            files = [f.name for f in subdir_path.glob("*.md")]
            if files:
                subdirs[subdir_name] = sorted(files)

    skill_style = detect_skill_style(body, subdirs)

    # Extract sections for quality assessment
    has_when_to_use = bool(re.search(r"##\s*When\s+to\s+Use", body, re.IGNORECASE))
    has_quick_start = bool(
        re.search(r"##\s*(Quick\s+Start|Quick\s+Examples?)", body, re.IGNORECASE)
    )
    has_overview = bool(re.search(r"##\s*(Overview|Introduction|Purpose)", body, re.IGNORECASE))

    return {
        "skill_id": f".skills/{skill_dir.name}",
        "name": frontmatter.get("name"),
        "description": frontmatter.get("description", ""),
        "allowed_tools": frontmatter.get("allowed-tools", []),
        "skill_style": skill_style,
        "subdirectory_files": subdirs,
        "structure": {
            "has_when_to_use": has_when_to_use,
            "has_quick_start": has_quick_start,
            "has_overview": has_overview,
        },
        "skill_path": str(skill_md.relative_to(skill_dir.parent.parent)),
        "content_length": len(body),
        "source": "golden_example",
    }


