<!-- Chunk 1669: bytes 6686533-6687665, type=function -->
def resolve_repo_relative_path(path: str | Path, *, config_path: Path | None = None) -> Path:
    """
    Resolve a repo-style relative path with fallbacks for installed wheels.

    This is primarily for paths like `config/training/trainset.json` referenced in
    code/config. Resolution order:
    1) Current working directory relative path (if it exists)
    2) Repo root relative path (if in a checkout)
    3) Packaged config directory (for `config/...` paths)
    4) Return the original relative path (best-effort)
    """
    candidate = Path(path)
    if candidate.is_absolute():
        return candidate

    if candidate.exists():
        return candidate

    repo_root = find_repo_root(Path.cwd())
    if repo_root:
        repo_candidate = repo_root / candidate
        if repo_candidate.exists():
            return repo_candidate

    parts = candidate.parts
    if parts and parts[0] == "config":
        base = (config_path or default_config_path()).parent
        packaged_candidate = base.joinpath(*parts[1:])
        if packaged_candidate.exists():
            return packaged_candidate

    return candidate


