<!-- Chunk 1560: bytes 6435619-6437052, type=function -->
def _extract_named_file_code_blocks(skill_md: str) -> dict[str, str]:
    """
    Extract code blocks that are explicitly labeled with a backticked filename heading.

    Example:
        ### `pytest.ini`
        ```ini
        ...
        ```

    """
    assets: dict[str, str] = {}
    lines = skill_md.splitlines()
    i = 0
    while i < len(lines):
        m = _HEADING_BACKTICK_RE.match(lines[i])
        if not m:
            i += 1
            continue

        raw_name = m.group("name")
        filename = _safe_single_filename(raw_name)
        if not filename:
            i += 1
            continue

        # Scan forward until we find the next fenced block (allow brief prose between).
        j = i + 1
        fence_line = None
        while j < len(lines):
            if lines[j].lstrip().startswith("#"):
                break
            if _FENCE_START_RE.match(lines[j]):
                fence_line = j
                break
            j += 1
        if fence_line is None:
            i += 1
            continue

        j = fence_line + 1
        body: list[str] = []
        while j < len(lines) and not lines[j].strip().startswith("```"):
            body.append(lines[j])
            j += 1

        if j < len(lines) and lines[j].strip().startswith("```"):
            assets[filename] = "\n".join(body).rstrip() + "\n"
            i = j + 1
            continue

        i += 1

    return assets


