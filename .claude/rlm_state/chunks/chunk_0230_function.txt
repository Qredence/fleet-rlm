<!-- Chunk 230: bytes 306718-307230, type=function -->
def generate_report(users):
    result = []
    for user in users:
        # Complex calculation (10 lines)
        score = 0
        for activity in user.activities:
            if activity.type == "login":
                score += 1
            elif activity.type == "purchase":
                score += 5
            elif activity.type == "review":
                score += 3
        user_data = {"name": user.name, "score": score}
        result.append(user_data)
    return result
```

**After:**
```python
